<!DOCTYPE html>
<html>
	<head>
		<title>TigerGrowl</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Bootstrap -->
		<link href="../static/css/customstyle.css" rel="stylesheet" media="screen">
		<link href='http://fonts.googleapis.com/css?family=Patrick+Hand+SC' rel='stylesheet' type='text/css'>
				<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="../static/js/jquery-1.11.0.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="../static/js/bootstrap.min.js"></script>
		<script src="../static/js/fb.js"></script>

		<!-- Necessary to verify user is logged in to fb -->
		<script type="text/javascript">
			window.onload = function() {
				var a = document.getElementById("mymealslink")
				a.onclick = function() {
					setTimeout(function() {
					window.location = location.protocol + '//' + location.host + "/mymeals/" + window.uid;
				}, 100);
				}
			}
		</script>

	</head>
	<body>
					<nav class="navbar-wrapper navbar-inverse navbar-fixed-top" role="navigation">
					<div class="container">
					<!-- Brand and toggle get grouped for better mobile display -->
					<div class="navbar-header">
						<a class="navbar-brand logo" style="color:white;" href="">TigerGrowl</a>
					</div>

					<a id = "mymealslink"><button type="button" class="btn btn-default navbar-btn"><span class="glyphicon glyphicon-user"></span> My Meals</button></a>

					
					</div><!-- /.navbar-collapse -->
				</div>
				</nav>
				<div class="container-fluid">
					<div class="jumbotron">
							<a href="registermeal"><button type="button" class="btn btn-default btn-lg">
								Host a Meal
							</button></a>
					</div>
				</div>

				<!-- Main feed container -->
				<div class="container">
					
					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div> 
						<a id="button1" href="#"><button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button> </a>
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<a id="button2" href="#"><button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button>  </a>
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<a id="button3" href="#"><button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button> </a>
					</div>
					
					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<a id="button4" href="#"><button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button> </a>
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<a id="button5" href="#"><button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button> </a>
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button>  
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button>  
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button>  
					</div>

					<div class="row feed-row">
						<div class="name-identifier"> firstname lastname's Meal </div>
						<div class="setting-identifier"> place date time </div>
						<div class="attendees">Who's Coming?</div>
						<button class="btn btn-primary btn-large" style="margin-left: 110px;margin-top: 75px;"><span class="glyphicon glyphicon-exclamation-sign"></span> Join Meal</button> 
					</div>
				<!-- The end of the container feed -->
				</div>
				<!-- Populate the rows of -->
				<script>

				var obj = jQuery.parseJSON( {{mealList|tojson|safe}} );

				$( document ).ready(function() {
					$(".feed-row:nth-child(1) .name-identifier").text(obj[0][1] + "\'s Meal");
					$(".feed-row:nth-child(2) .name-identifier").text(obj[1][1] + "\'s Meal");
					$(".feed-row:nth-child(3) .name-identifier").text(obj[2][1] + "\'s Meal");
					$(".feed-row:nth-child(4) .name-identifier").text(obj[3][1] + "\'s Meal");
					$(".feed-row:nth-child(5) .name-identifier").text(obj[4][1] + "\'s Meal");
					$(".feed-row:nth-child(1) .setting-identifier").text(obj[0][2] + ", " + obj[0][3] + ", " + obj[0][4]);
					$(".feed-row:nth-child(2) .setting-identifier").text(obj[1][2] + ", " + obj[1][3] + ", " + obj[1][4]);
					$(".feed-row:nth-child(3) .setting-identifier").text(obj[2][2] + ", " + obj[2][3] + ", " + obj[2][4]);
					$(".feed-row:nth-child(4) .setting-identifier").text(obj[3][2] + ", " + obj[3][3] + ", " + obj[3][4]);
					$(".feed-row:nth-child(5) .setting-identifier").text(obj[4][2] + ", " + obj[4][3] + ", " + obj[4][4]);
				});
				
				</script>

				<script>
					$(document).bind('fbInit',function(){
    				console.log('fbInit complete; FB Object is Available');
    				$("#button1").prop("href", "joinmeal/" + obj[0][0] + "/" + window.uid);
    				$("#button2").prop("href", "joinmeal/" + obj[1][0] + "/" + window.uid);
    				$("#button3").prop("href", "joinmeal/" + obj[2][0] + "/" + window.uid);
    				$("#button4").prop("href", "joinmeal/" + obj[3][0] + "/" + window.uid);
    				$("#button5").prop("href", "joinmeal/" + obj[4][0] + "/" + window.uid);
					});
				</script>

				<footer>
					<div class="container">
					<div class="row">
						<div class="col" style="text-align:center;">&copy; 2014 TigerGrowl</div>
						<div class="col-md-4">
							<ul class="nav nav-pills">
								
							</ul>
						</div>

						</div>
					</div>
					</div>
				</footer>
				<div id="fb-root"></div>
		<script type="text/javascript">
		window.fbAsyncInit = function() {
					FB.init({
						appId      : '1423477091234772',
						status     : true, // check login status
						cookie     : true, // enable cookies to allow the server to access the session
						xfbml      : true  // parse XFBML
					});
					console.log("here")
					FB.getLoginStatus(function(response) {
					  if (response.status === 'connected') {
					    uid = response.authResponse.userID;
					    $(document).trigger('fbInit');
					  }
					  else {
					  } 
					 });
				}
		</script>
	</body>
</html>